<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: 'en' }}" data-theme="light">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  {%- seo -%}
  
  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
  
  {%- feed_meta -%}
  {%- if jekyll.environment == 'production' and site.google_analytics -%}
    {%- include google-analytics.html -%}
  {%- endif -%}
  
  <!-- Preload critical fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
  {%- include header.html -%}

  <main class="page-content" aria-label="Content">
    <div class="wrapper">
      {{ content }}
    </div>
  </main>

  {%- include footer.html -%}

  <!-- Enhanced accessibility and mobile support -->
  <script>
    // Enhanced mobile support
    document.addEventListener('DOMContentLoaded', function() {
      // Add touch-friendly hover states for mobile
      if ('ontouchstart' in window) {
        document.body.classList.add('touch-device');
      }

      // Improve mobile scroll behavior
      let touchStartY = 0;
      document.addEventListener('touchstart', function(e) {
        touchStartY = e.touches[0].clientY;
      }, { passive: true });

      // Handle mobile menu accessibility
      const navLinks = document.querySelectorAll('.nav-link');
      navLinks.forEach(link => {
        link.addEventListener('click', function() {
          // Close mobile menu when link is clicked
          const mobileToggle = document.querySelector('.mobile-menu-toggle');
          const navMenu = document.querySelector('.nav-menu');
          if (mobileToggle && navMenu) {
            mobileToggle.setAttribute('aria-expanded', 'false');
            navMenu.classList.remove('active');
          }
        });
      });

      // Enhanced keyboard navigation
      document.addEventListener('keydown', function(event) {
        // Skip link navigation
        if (event.key === 'Tab' && event.target.classList.contains('skip-link')) {
          event.preventDefault();
          const mainContent = document.querySelector('main');
          if (mainContent) {
            mainContent.focus();
          }
        }
      });
    });

    // Performance optimization: Lazy load images
    if ('IntersectionObserver' in window) {
      const imageObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const img = entry.target;
            img.src = img.dataset.src;
            img.classList.remove('lazy');
            imageObserver.unobserve(img);
          }
        });
      });

      document.querySelectorAll('img[data-src]').forEach(img => {
        imageObserver.observe(img);
      });
    }
  </script>
</body>
</html>