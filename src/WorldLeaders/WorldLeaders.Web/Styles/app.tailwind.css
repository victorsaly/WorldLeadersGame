@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
@import './pixel-world-map.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

/* Retro 32-bit Color Palette - Child Designer Approved */
:root {
  /* Primary Green Theme (from README inspiration) */
  --retro-green-dark: #1a5a1a;
  --retro-green-main: #2ea44f;
  --retro-green-primary: #2ea44f;  /* Added for compatibility */
  --retro-green-light: #4ade80;
  --retro-green-bright: #86efac;
  
  /* Classic 32-bit Supporting Colors */
  --retro-blue: #3b82f6;
  --retro-purple: #8b5cf6;
  --retro-yellow: #eab308;
  --retro-red: #ef4444;
  --retro-orange: #f97316;
  
  /* Pixel Art Neutrals */
  --pixel-black: #000000;
  --pixel-dark-gray: #374151;
  --pixel-gray: #6b7280;
  --pixel-light-gray: #d1d5db;
  --pixel-white: #ffffff;
  
  /* High Contrast Text Colors for Accessibility */
  --text-on-light: #000000;
  --text-on-dark: #ffffff;
  --text-on-green: #ffffff;
  --text-on-blue: #ffffff;
  --text-on-red: #ffffff;

  /* Mobile-First Touch Interface Standards */
  /* Touch-friendly sizing (44px minimum for WCAG compliance) */
  --touch-target-small: 44px;
  --touch-target-medium: 56px;
  --touch-target-large: 72px;
  
  /* Mobile-first spacing system */
  --mobile-spacing-xs: 0.5rem;   /* 8px */
  --mobile-spacing-sm: 1rem;     /* 16px */
  --mobile-spacing-md: 1.5rem;   /* 24px */
  --mobile-spacing-lg: 2rem;     /* 32px */
  --mobile-spacing-xl: 2.5rem;   /* 40px */
  
  /* Mobile-first typography scale */
  --mobile-text-xs: 12px;
  --mobile-text-sm: 14px;
  --mobile-text-base: 16px;
  --mobile-text-lg: 20px;
  --mobile-text-xl: 24px;
  --mobile-text-2xl: 28px;
  
  /* Mobile-specific line heights for readability */
  --mobile-leading-tight: 1.25;
  --mobile-leading-normal: 1.5;
  --mobile-leading-relaxed: 1.75;
}

/* Custom child-friendly component classes */
@layer components {
  /* Mobile-First Responsive Container System */
  .retro-mobile-container {
    width: 100%;
    margin: 0 auto;
    padding: var(--mobile-spacing-sm);
    font-family: 'Press Start 2P', 'Courier New', monospace;
    
    /* Base mobile styles (320px+) */
    font-size: var(--mobile-text-xs);
    line-height: var(--mobile-leading-normal);
  }

  /* Mobile Portrait Optimization (320px - 480px) */
  @media (max-width: 480px) {
    .retro-mobile-container {
      padding: var(--mobile-spacing-xs);
      font-size: var(--mobile-text-xs);
    }
    
    .retro-mobile-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: var(--mobile-spacing-sm);
    }
    
    .retro-mobile-stack {
      display: flex;
      flex-direction: column;
      gap: var(--mobile-spacing-sm);
    }
  }

  /* Mobile Landscape & Small Tablets (481px - 768px) */
  @media (min-width: 481px) and (max-width: 768px) {
    .retro-mobile-container {
      padding: var(--mobile-spacing-sm);
      font-size: var(--mobile-text-sm);
      max-width: 680px;
    }
    
    .retro-mobile-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: var(--mobile-spacing-md);
    }
  }

  /* Tablets (769px - 1024px) */
  @media (min-width: 769px) {
    .retro-mobile-container {
      padding: var(--mobile-spacing-md);
      font-size: var(--mobile-text-base);
      max-width: 900px;
    }
    
    .retro-mobile-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: var(--mobile-spacing-lg);
    }
  }

  /* Desktop (1025px+) */
  @media (min-width: 1025px) {
    .retro-mobile-container {
      padding: var(--mobile-spacing-lg);
      font-size: var(--mobile-text-lg);
      max-width: 1200px;
    }
  }

  /* Retro 32-bit Game Container - Mobile Enhanced */
  .retro-game-container {
    background: linear-gradient(135deg, 
      var(--retro-green-dark) 0%, 
      var(--retro-green-main) 50%, 
      var(--retro-green-light) 100%);
    font-family: 'Press Start 2P', 'Courier New', monospace;
    image-rendering: pixelated;
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
    min-height: 100vh;
    min-height: 100dvh; /* Use dynamic viewport height for mobile */
    
    /* Mobile-first responsive text sizing */
    font-size: var(--mobile-text-xs);
    padding: var(--mobile-spacing-sm);
  }

  @media (min-width: 480px) {
    .retro-game-container {
      font-size: var(--mobile-text-sm);
      padding: var(--mobile-spacing-md);
    }
  }

  @media (min-width: 768px) {
    .retro-game-container {
      font-size: var(--mobile-text-base);
      padding: var(--mobile-spacing-lg);
    }
  }

  /* Mobile-First Retro Touch Button System */
  .retro-touch-button {
    @apply relative font-bold cursor-pointer;
    min-width: var(--touch-target-medium);
    min-height: var(--touch-target-medium);
    padding: var(--mobile-spacing-sm) var(--mobile-spacing-md);
    background: var(--retro-green-main);
    border: 3px solid var(--pixel-white);
    color: var(--pixel-white);
    font-family: 'Press Start 2P', monospace;
    font-size: var(--mobile-text-xs);
    text-transform: uppercase;
    letter-spacing: 1px;
    line-height: var(--mobile-leading-tight);
    touch-action: manipulation;
    user-select: none;
    box-shadow: 
      inset 2px 2px 0 var(--retro-green-light),
      inset -2px -2px 0 var(--retro-green-dark),
      4px 4px 0 var(--pixel-dark-gray);
    transition: all 0.1s ease;
    image-rendering: pixelated;
  }

  .retro-touch-button:hover {
    transform: translate(2px, 2px);
    box-shadow: 
      inset 2px 2px 0 var(--retro-green-light),
      inset -2px -2px 0 var(--retro-green-dark),
      2px 2px 0 var(--pixel-dark-gray);
  }

  .retro-touch-button:active {
    transform: translate(4px, 4px);
    box-shadow: 
      inset 2px 2px 0 var(--retro-green-dark),
      inset -2px -2px 0 var(--retro-green-light);
  }

  /* Large touch button for primary actions */
  .retro-touch-button-large {
    @apply retro-touch-button;
    min-width: var(--touch-target-large);
    min-height: var(--touch-target-large);
    padding: var(--mobile-spacing-md) var(--mobile-spacing-lg);
    font-size: var(--mobile-text-sm);
  }

  /* Enhanced Retro Pixel Art Button - Mobile Optimized */
  .pixel-art-button {
    @apply relative font-bold text-white cursor-pointer;
    background: var(--retro-green-main);
    border: 4px solid var(--pixel-white);
    box-shadow: 
      inset 2px 2px 0 var(--retro-green-light),
      inset -2px -2px 0 var(--retro-green-dark),
      4px 4px 0 var(--pixel-dark-gray);
    font-family: 'Press Start 2P', monospace;
    text-transform: uppercase;
    letter-spacing: 1px;
    transition: all 0.1s ease;
    image-rendering: pixelated;
    touch-action: manipulation;
    user-select: none;
    
    /* Mobile-first sizing */
    min-height: var(--touch-target-medium);
    min-width: var(--touch-target-medium);
    padding: var(--mobile-spacing-sm) var(--mobile-spacing-md);
    font-size: var(--mobile-text-xs);
    line-height: var(--mobile-leading-tight);
  }

  /* Responsive font scaling for buttons */
  @media (min-width: 480px) {
    .pixel-art-button {
      font-size: var(--mobile-text-sm);
      padding: var(--mobile-spacing-md) var(--mobile-spacing-lg);
    }
  }

  @media (min-width: 768px) {
    .pixel-art-button {
      font-size: 12px;
      padding: 12px 24px;
    }
  }

  .pixel-art-button:hover {
    transform: translate(2px, 2px);
    box-shadow: 
      inset 2px 2px 0 var(--retro-green-light),
      inset -2px -2px 0 var(--retro-green-dark),
      2px 2px 0 var(--pixel-dark-gray);
  }

  .pixel-art-button:active {
    transform: translate(4px, 4px);
    box-shadow: 
      inset 2px 2px 0 var(--retro-green-dark),
      inset -2px -2px 0 var(--retro-green-light);
  }

  /* Mobile-Optimized Navigation Button */
  .pixel-art-button-small {
    position: relative;
    font-weight: bold;
    color: var(--text-on-green);
    cursor: pointer;
    text-decoration: none;
    display: inline-block;
    background: var(--retro-green-main);
    border: 2px solid var(--pixel-white);
    box-shadow: 
      inset 1px 1px 0 var(--retro-green-light),
      inset -1px -1px 0 var(--retro-green-dark),
      2px 2px 0 var(--pixel-dark-gray);
    font-family: 'Press Start 2P', monospace;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    transition: all 0.1s ease;
    image-rendering: pixelated;
    touch-action: manipulation;
    user-select: none;
    
    /* Mobile-first sizing */
    min-height: var(--touch-target-small);
    min-width: var(--touch-target-small);
    padding: var(--mobile-spacing-xs) var(--mobile-spacing-sm);
    font-size: var(--mobile-text-xs);
    line-height: var(--mobile-leading-tight);
  }

  @media (min-width: 480px) {
    .pixel-art-button-small {
      padding: var(--mobile-spacing-sm) var(--mobile-spacing-md);
      font-size: var(--mobile-text-xs);
    }
  }

  @media (min-width: 768px) {
    .pixel-art-button-small {
      padding: 8px 12px;
      font-size: 8px;
      min-height: 32px;
      line-height: 1.2;
    }
  }

  .pixel-art-button-small:hover {
    transform: translate(1px, 1px);
    box-shadow: 
      inset 1px 1px 0 var(--retro-green-light),
      inset -1px -1px 0 var(--retro-green-dark),
      1px 1px 0 var(--pixel-dark-gray);
    color: var(--text-on-green);
    text-decoration: none;
  }

  .pixel-art-button-small:active {
    transform: translate(2px, 2px);
    box-shadow: 
      inset 1px 1px 0 var(--retro-green-dark),
      inset -1px -1px 0 var(--retro-green-light);
    color: var(--text-on-green);
  }

  /* Blue variant for login */
  .pixel-art-button-small.blue {
    background: var(--retro-blue);
    color: var(--text-on-blue);
    box-shadow: 
      inset 1px 1px 0 #60a5fa,
      inset -1px -1px 0 #1d4ed8,
      2px 2px 0 var(--pixel-dark-gray);
  }

  .pixel-art-button-small.blue:hover {
    color: var(--text-on-blue);
    box-shadow: 
      inset 1px 1px 0 #60a5fa,
      inset -1px -1px 0 #1d4ed8,
      1px 1px 0 var(--pixel-dark-gray);
  }

  /* Red variant for logout */
  .pixel-art-button-small.red {
    background: var(--retro-red);
    color: var(--text-on-red);
    box-shadow: 
      inset 1px 1px 0 #f87171,
      inset -1px -1px 0 #dc2626,
      2px 2px 0 var(--pixel-dark-gray);
  }

  .pixel-art-button-small.red:hover {
    color: var(--text-on-red);
    box-shadow: 
      inset 1px 1px 0 #f87171,
      inset -1px -1px 0 #dc2626,
      1px 1px 0 var(--pixel-dark-gray);
  }

  /* Mobile-Optimized Retro Pixel Art Card */
  .pixel-art-card {
    @apply relative bg-white;
    border: 4px solid var(--pixel-black);
    box-shadow: 
      4px 4px 0 var(--pixel-gray),
      8px 8px 0 var(--pixel-black);
    image-rendering: pixelated;
    transition: all 0.2s ease;
    touch-action: manipulation;
    
    /* Mobile-first responsive padding */
    padding: var(--mobile-spacing-sm);
  }

  @media (min-width: 480px) {
    .pixel-art-card {
      padding: var(--mobile-spacing-md);
    }
  }

  @media (min-width: 768px) {
    .pixel-art-card {
      padding: 1.5rem;
    }
  }

  .pixel-art-card:hover {
    transform: translate(-2px, -2px);
    box-shadow: 
      6px 6px 0 var(--pixel-gray),
      10px 10px 0 var(--pixel-black);
  }

  .pixel-art-card.green-theme {
    background: linear-gradient(135deg, 
      var(--retro-green-light) 0%, 
      var(--pixel-white) 100%);
    border-color: var(--retro-green-main);
  }

  .pixel-art-card.red-theme {
    background: linear-gradient(135deg, 
      #fca5a5 0%, 
      var(--pixel-white) 100%);
    border-color: var(--retro-red);
  }

  /* Mobile-First Retro Typography */
  .retro-title {
    font-family: 'Press Start 2P', monospace;
    color: var(--pixel-white);
    text-shadow: 
      2px 2px 0 var(--pixel-black),
      4px 4px 0 var(--retro-green-dark);
    image-rendering: pixelated;
    letter-spacing: 2px;
    line-height: var(--mobile-leading-tight);
    
    /* Mobile-first responsive sizing */
    font-size: var(--mobile-text-lg);
  }

  @media (min-width: 480px) {
    .retro-title {
      font-size: var(--mobile-text-xl);
    }
  }

  @media (min-width: 768px) {
    .retro-title {
      font-size: var(--mobile-text-2xl);
    }
  }

  .retro-subtitle {
    font-family: 'Press Start 2P', monospace;
    color: var(--retro-green-bright);
    letter-spacing: 2px;
    image-rendering: pixelated;
    line-height: var(--mobile-leading-normal);
    
    /* Mobile-first responsive sizing */
    font-size: var(--mobile-text-xs);
  }

  @media (min-width: 480px) {
    .retro-subtitle {
      font-size: var(--mobile-text-sm);
    }
  }

  @media (min-width: 768px) {
    .retro-subtitle {
      font-size: 12px;
    }
  }

  .retro-body {
    font-family: 'Orbitron', 'Courier New', monospace;
    color: var(--text-on-light);
    font-weight: 600;
    line-height: var(--mobile-leading-relaxed);
    
    /* Mobile-first responsive sizing */
    font-size: var(--mobile-text-sm);
  }

  @media (min-width: 480px) {
    .retro-body {
      font-size: var(--mobile-text-base);
    }
  }

  @media (min-width: 768px) {
    .retro-body {
      line-height: 1.6;
    }
  }

  /* Text variants for different backgrounds */
  .retro-body.on-dark {
    color: var(--text-on-dark) !important;
  }

  .retro-body.on-green {
    color: var(--text-on-green) !important;
  }

  .retro-body.on-blue {
    color: var(--text-on-blue) !important;
  }

  /* Override common Tailwind color classes for retro-body */
  .retro-body.text-white {
    color: var(--text-on-dark) !important;
  }

  .retro-body.text-black {
    color: var(--text-on-light) !important;
  }

  .retro-body.text-gray-600 {
    color: #4b5563 !important;
  }

  .retro-body.text-green-700 {
    color: #15803d !important;
  }

  .retro-body.text-orange-600 {
    color: #ea580c !important;
  }

  .retro-body.text-orange-700 {
    color: #c2410c !important;
  }

  /* For form labels - ensure they're always visible */
  .retro-body.font-bold {
    color: var(--pixel-black) !important;
    font-weight: 800;
  }

  /* Pixel Art Image Rendering */
  .pixel-image {
    image-rendering: pixelated;
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
  }

  /* Mobile-First Character Selection Components */
  .character-selection-grid {
    display: grid;
    gap: var(--mobile-spacing-sm);
    padding: var(--mobile-spacing-sm);
    
    /* Mobile-first responsive grid */
    grid-template-columns: 1fr;
  }

  @media (min-width: 480px) {
    .character-selection-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: var(--mobile-spacing-md);
    }
  }

  @media (min-width: 768px) {
    .character-selection-grid {
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      padding: 20px;
    }
  }

  .character-card {
    @apply bg-white border-4 border-black cursor-pointer text-center;
    box-shadow: 4px 4px 0 var(--pixel-gray);
    transition: all 0.1s ease-in-out;
    image-rendering: pixelated;
    touch-action: manipulation;
    user-select: none;
    
    /* Mobile-first responsive padding */
    padding: var(--mobile-spacing-sm);
    min-height: var(--touch-target-large);
  }

  @media (min-width: 480px) {
    .character-card {
      padding: var(--mobile-spacing-md);
    }
  }

  @media (min-width: 768px) {
    .character-card {
      padding: 1rem;
    }
  }

  .character-card:hover {
    transform: translate(-2px, -2px);
    box-shadow: 6px 6px 0 var(--pixel-gray);
  }

  .character-card.selected {
    border-color: var(--retro-green-main);
    background: linear-gradient(135deg, 
        var(--retro-green-light) 0%, 
        var(--pixel-white) 100%);
  }

  .character-avatar {
    @apply mx-auto mb-3;
    image-rendering: pixelated;
    
    /* Mobile-first responsive sizing */
    width: var(--touch-target-medium);
    height: var(--touch-target-medium);
  }

  @media (min-width: 768px) {
    .character-avatar {
      width: 4rem;
      height: 4rem;
    }
  }

  .trait-badge {
    @apply inline-block;
    background: var(--retro-green-main);
    color: white;
    border: 1px solid var(--pixel-black);
    font-family: 'Press Start 2P', monospace;
    
    /* Mobile-first responsive sizing */
    padding: var(--mobile-spacing-xs) var(--mobile-spacing-sm);
    font-size: var(--mobile-text-xs);
    min-height: var(--touch-target-small);
  }

  @media (min-width: 768px) {
    .trait-badge {
      padding: 0.25rem 0.5rem;
      font-size: 8px;
    }
  }

  /* Legacy child-friendly components updated for retro */
  .btn-child-friendly {
    @apply pixel-art-button;
  }

  .btn-child-success {
    @apply pixel-art-button;
    background: var(--retro-green-bright);
  }

  /* Retro Game Animations */
  .retro-bounce {
    animation: retro-bounce 1s ease-in-out infinite;
  }

  .retro-glow {
    animation: retro-glow 2s ease-in-out infinite;
  }

  .retro-shimmer {
    animation: pixel-shimmer 1.5s ease-in-out infinite;
  }

  /* Mobile-Optimized Retro Progress Bar */
  .retro-progress-bar {
    @apply w-full border-4 border-black bg-gray-200;
    image-rendering: pixelated;
    box-shadow: inset 2px 2px 0 var(--pixel-gray);
    
    /* Mobile-first responsive height */
    height: var(--touch-target-small);
  }

  @media (min-width: 768px) {
    .retro-progress-bar {
      height: 1.5rem;
    }
  }

  .retro-progress-fill {
    @apply h-full transition-all duration-1000 ease-out;
    background: linear-gradient(135deg, 
      var(--retro-green-main) 0%, 
      var(--retro-green-bright) 100%);
    box-shadow: inset 1px 1px 0 var(--retro-green-light);
  }

  /* Mobile Touch Optimization for Retro Interface */
  .retro-touch-target {
    min-height: var(--touch-target-medium);
    min-width: var(--touch-target-medium);
    touch-action: manipulation;
    user-select: none;
    
    /* Ensure adequate spacing between touch targets */
    margin: var(--mobile-spacing-xs);
  }

  .retro-touch-target-large {
    min-height: var(--touch-target-large);
    min-width: var(--touch-target-large);
    touch-action: manipulation;
    user-select: none;
    margin: var(--mobile-spacing-sm);
  }

  /* Mobile-First Form Controls */
  .retro-input {
    @apply w-full border-4 border-black bg-white;
    image-rendering: pixelated;
    font-family: 'Press Start 2P', monospace;
    box-shadow: inset 2px 2px 0 var(--pixel-gray);
    
    /* Mobile-first sizing */
    min-height: var(--touch-target-medium);
    padding: var(--mobile-spacing-sm);
    font-size: var(--mobile-text-sm);
  }

  .retro-input:focus {
    outline: none;
    border-color: var(--retro-green-main);
    box-shadow: 
      inset 2px 2px 0 var(--pixel-gray),
      0 0 0 4px rgba(46, 164, 79, 0.3);
  }

  /* Mobile-optimized modal/popup */
  .retro-modal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    padding: var(--mobile-spacing-sm);
  }

  .retro-modal-content {
    @apply bg-white border-4 border-black;
    box-shadow: 8px 8px 0 var(--pixel-dark-gray);
    image-rendering: pixelated;
    max-width: 100%;
    max-height: 90vh;
    overflow-y: auto;
    
    /* Mobile-first responsive sizing */
    width: 100%;
    padding: var(--mobile-spacing-md);
  }

  @media (min-width: 480px) {
    .retro-modal-content {
      width: 90%;
      max-width: 500px;
    }
  }

  @media (min-width: 768px) {
    .retro-modal-content {
      padding: var(--mobile-spacing-lg);
      max-width: 600px;
    }
  }
  .btn-child-friendly {
    @apply px-8 py-4 min-h-[56px] min-w-[120px];
    @apply text-child-lg font-bold tracking-wide;
    @apply rounded-child-lg shadow-child-friendly;
    @apply border-4 border-white border-opacity-20;
    @apply transform transition-all duration-300;
    @apply hover:scale-105 hover:shadow-child-hover active:scale-95;
    @apply bg-gradient-to-r from-game-primary-500 to-game-secondary-600 text-white;
  }

  .btn-child-success {
    @apply btn-child-friendly;
    @apply bg-gradient-to-r from-game-success-500 to-game-primary-500;
  }

  .card-child {
    @apply p-6 md:p-8 rounded-child-xl shadow-child-friendly;
    @apply border-4 border-opacity-10 border-game-primary-200;
    @apply min-h-[120px] bg-white;
    @apply transform transition-all duration-300 hover:scale-102;
  }

  .educational-card {
    @apply card-child;
    @apply bg-gradient-to-br from-white to-game-primary-50;
    @apply border-game-primary-300;
  }

  .progress-meter {
    @apply w-full bg-gray-200 rounded-full h-6 overflow-hidden;
    @apply border-2 border-gray-300 shadow-inner;
  }

  .progress-fill {
    @apply bg-gradient-to-r from-game-success-400 to-game-primary-500 h-full rounded-full;
    @apply transition-all duration-1000 ease-out;
    @apply shadow-lg;
  }

  .dice-container {
    @apply flex flex-col items-center space-y-4 p-6;
    @apply bg-gradient-to-br from-game-secondary-500 to-game-primary-600 rounded-child-xl;
    @apply cursor-pointer transform transition-all duration-300;
    @apply hover:scale-105 active:scale-95 shadow-child-friendly;
  }

  .territory-card {
    @apply card-child cursor-pointer;
    @apply border-transparent hover:border-game-primary-400;
    @apply hover:shadow-child-hover;
  }

  .territory-card.owned {
    @apply border-game-success-200 bg-game-success-50;
    @apply hover:border-game-success-400;
  }

  .input-child {
    @apply px-4 py-3 text-child-base rounded-child;
    @apply border-2 border-gray-300 focus:border-game-primary-500;
    @apply min-h-[48px] min-w-[200px];
    @apply focus:ring-4 focus:ring-game-primary-200 focus:ring-opacity-50;
    @apply transition-all duration-200;
  }

  .game-layout {
    @apply min-h-screen bg-gradient-to-br from-game-primary-50 via-white to-game-secondary-50;
    @apply font-readable text-child-base text-gray-800;
  }

  .game-header {
    @apply bg-white shadow-child-friendly border-b-4 border-game-primary-200;
    @apply p-4 md:p-6;
  }

  .game-content {
    @apply container mx-auto px-4 py-6 md:py-8;
    @apply max-w-7xl;
  }

  .loading-spinner {
    @apply relative w-16 h-16 mx-auto;
  }

  .spinner-ring {
    @apply absolute inset-0 border-4 border-game-primary-200 border-t-game-primary-500 rounded-full;
    animation: spin 1s linear infinite;
  }

  .achievement-celebration {
    animation: celebrate 1000ms ease-out;
  }

  .resource-update {
    animation: countUp 500ms ease-in;
  }

  /* Retro Loading Spinner */
  .retro-loading-spinner {
    width: 24px;
    height: 24px;
    border: 4px solid var(--pixel-black);
    border-top: 4px solid var(--retro-green-main);
    border-radius: 0;
    animation: retro-spin 1s linear infinite;
    image-rendering: pixelated;
  }

  @keyframes retro-spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
}

/* Custom animations for educational feedback */
@keyframes celebrate {
  0% { transform: scale(1) rotate(0deg); }
  25% { transform: scale(1.1) rotate(5deg); }
  50% { transform: scale(1.2) rotate(-5deg); }
  75% { transform: scale(1.1) rotate(3deg); }
  100% { transform: scale(1) rotate(0deg); }
}

@keyframes countUp {
  0% { transform: translateY(20px); opacity: 0; }
  100% { transform: translateY(0); opacity: 1; }
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Retro Game Animations */
@keyframes retro-bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-8px); }
}

@keyframes retro-glow {
  0%, 100% { 
    box-shadow: 0 0 5px var(--retro-green-main);
  }
  50% { 
    box-shadow: 0 0 20px var(--retro-green-main),
                0 0 30px var(--retro-green-light);
  }
}

@keyframes pixel-shimmer {
  0% { opacity: 1; }
  50% { opacity: 0.7; }
  100% { opacity: 1; }
}

/* Child-friendly accessibility improvements */
@layer utilities {
  .focus-child {
    @apply focus:outline-none focus:ring-4 focus:ring-game-primary-300;
    @apply focus:ring-opacity-50 focus:border-game-primary-500;
  }

  .text-child-readable {
    @apply text-child-base leading-relaxed font-readable;
  }

  /* Mobile-First Touch Utilities */
  .touch-child {
    min-height: var(--touch-target-small);
    min-width: var(--touch-target-small);
    touch-action: manipulation;
    user-select: none;
  }

  .touch-child-comfortable {
    min-height: var(--touch-target-medium);
    min-width: var(--touch-target-medium);
    touch-action: manipulation;
    user-select: none;
  }

  .touch-child-large {
    min-height: var(--touch-target-large);
    min-width: var(--touch-target-large);
    touch-action: manipulation;
    user-select: none;
  }

  /* Mobile-first spacing utilities */
  .mobile-spacing-xs { padding: var(--mobile-spacing-xs); }
  .mobile-spacing-sm { padding: var(--mobile-spacing-sm); }
  .mobile-spacing-md { padding: var(--mobile-spacing-md); }
  .mobile-spacing-lg { padding: var(--mobile-spacing-lg); }
  .mobile-spacing-xl { padding: var(--mobile-spacing-xl); }

  /* Mobile-first gap utilities */
  .mobile-gap-xs { gap: var(--mobile-spacing-xs); }
  .mobile-gap-sm { gap: var(--mobile-spacing-sm); }
  .mobile-gap-md { gap: var(--mobile-spacing-md); }
  .mobile-gap-lg { gap: var(--mobile-spacing-lg); }

  /* Mobile-first text sizing */
  .mobile-text-xs { font-size: var(--mobile-text-xs); }
  .mobile-text-sm { font-size: var(--mobile-text-sm); }
  .mobile-text-base { font-size: var(--mobile-text-base); }
  .mobile-text-lg { font-size: var(--mobile-text-lg); }
  .mobile-text-xl { font-size: var(--mobile-text-xl); }

  /* High contrast mode for accessibility */
  @media (prefers-contrast: high) {
    .retro-game-container {
      background: var(--pixel-white);
      color: var(--pixel-black);
    }
    
    .pixel-art-button {
      border-width: 6px;
      box-shadow: 
        inset 3px 3px 0 var(--pixel-white),
        inset -3px -3px 0 var(--pixel-black),
        6px 6px 0 var(--pixel-black);
    }
    
    .pixel-art-card {
      border-width: 6px;
      box-shadow: 
        6px 6px 0 var(--pixel-black),
        12px 12px 0 var(--pixel-dark-gray);
    }
  }

  /* Reduced motion for accessibility */
  @media (prefers-reduced-motion: reduce) {
    .pixel-art-button,
    .pixel-art-card,
    .character-card,
    .retro-progress-fill {
      transition: none;
    }
    
    .retro-bounce,
    .retro-glow,
    .retro-shimmer {
      animation: none;
    }
  }

  /* Focus management for keyboard navigation */
  .retro-focus-ring {
    outline: 4px solid var(--retro-green-main);
    outline-offset: 4px;
  }

  /* Safe area insets for mobile devices */
  .mobile-safe-area {
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
  }

  /* Mobile-first main layout styles */
  .main-layout {
    width: 100vw;
    min-height: 100vh;
    min-height: 100dvh; /* Dynamic viewport height for mobile */
    margin: 0;
    padding: 0;
    background: linear-gradient(135deg, var(--retro-green-dark) 0%, var(--retro-green-main) 100%);
    font-family: 'Press Start 2P', 'Courier New', monospace;
    overflow-x: hidden; /* Prevent horizontal scroll on mobile */
  }

  .retro-main-header {
    position: sticky;
    top: 0;
    z-index: 50;
    background: var(--retro-green-main);
    box-shadow: 0 4px 0 var(--pixel-black);
    border-bottom: 4px solid var(--pixel-black);
    min-height: var(--touch-target-medium);
    padding: 0;
  }

  @media (min-width: 768px) {
    .retro-main-header {
      height: 60px;
    }
  }

  .retro-header-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 100%;
    padding: var(--mobile-spacing-xs) var(--mobile-spacing-sm);
    max-width: 100%;
  }

  @media (min-width: 768px) {
    .retro-header-content {
      padding: 0 1rem;
    }
  }

  .retro-main-content {
    padding: 0;
    max-width: 100%;
    margin: 0 auto;
    position: relative;
    /* Ensure content doesn't go under mobile nav */
    padding-bottom: calc(var(--touch-target-medium) + var(--mobile-spacing-sm));
  }

  @media (min-width: 1024px) {
    .retro-main-content {
      padding-bottom: 0;
    }
  }

  .mobile-nav-spacer {
    /* Extra space for mobile navigation on small screens */
    height: var(--touch-target-large);
  }

  @media (min-width: 1024px) {
    .mobile-nav-spacer {
      display: none;
    }
  }

  /* Mobile-optimized blazor error UI styling */
  #blazor-error-ui {
    background: var(--retro-red);
    color: var(--pixel-white);
    bottom: 0;
    box-shadow: 0 -4px 0 var(--pixel-black);
    display: none;
    left: 0;
    padding: var(--mobile-spacing-sm);
    position: fixed;
    width: 100%;
    z-index: 1000;
    font-family: 'Press Start 2P', monospace;
    font-size: var(--mobile-text-xs);
    border-top: 4px solid var(--pixel-black);
    text-align: center;
  }

  @media (min-width: 768px) {
    #blazor-error-ui {
      padding: 0.6rem 1.25rem 0.7rem 1.25rem;
      font-size: 12px;
    }
  }

  #blazor-error-ui .dismiss {
    cursor: pointer;
    position: absolute;
    right: var(--mobile-spacing-sm);
    top: 50%;
    transform: translateY(-50%);
    color: var(--pixel-white);
    font-weight: bold;
    min-height: var(--touch-target-small);
    min-width: var(--touch-target-small);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  #blazor-error-ui .reload {
    color: var(--pixel-white);
    text-decoration: underline;
    touch-action: manipulation;
  }

  /* Mobile-specific layout optimizations */
  @media (max-width: 480px) {
    .main-layout {
      font-size: var(--mobile-text-xs);
    }
    
    .retro-header-content {
      padding: var(--mobile-spacing-xs);
    }
  }

  /* Remove any default body margins for clean mobile layout */
  body, html {
    margin: 0;
    padding: 0;
    font-family: 'Press Start 2P', 'Courier New', monospace;
    overflow-x: hidden;
  }

  /* Mobile Navigation Styles */
  .retro-mobile-nav {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 100;
    background: var(--retro-green-main);
    border-top: 4px solid var(--pixel-black);
    box-shadow: 0 -4px 0 var(--pixel-dark-gray);
    padding: env(safe-area-inset-bottom) 0 0 0;
  }

  .retro-nav-bottom {
    padding: var(--mobile-spacing-xs) var(--mobile-spacing-sm);
  }

  .retro-nav-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: var(--mobile-spacing-xs);
    max-width: 100%;
  }

  .retro-nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    color: var(--pixel-white);
    font-family: 'Press Start 2P', monospace;
    transition: all 0.1s ease;
    border-radius: 4px;
    
    /* Touch-optimized sizing */
    min-height: var(--touch-target-medium);
    min-width: var(--touch-target-small);
    padding: var(--mobile-spacing-xs);
    touch-action: manipulation;
    user-select: none;
  }

  .retro-nav-item:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateY(-2px);
  }

  .retro-nav-item:active {
    transform: translateY(0);
    background: rgba(255, 255, 255, 0.2);
  }

  .retro-nav-item.active {
    background: var(--retro-green-bright);
    color: var(--pixel-black);
    border: 2px solid var(--pixel-white);
    box-shadow: inset 1px 1px 0 rgba(255, 255, 255, 0.3);
  }

  .retro-nav-icon {
    font-size: var(--mobile-text-lg);
    margin-bottom: var(--mobile-spacing-xs);
    line-height: 1;
  }

  .retro-nav-label {
    font-size: var(--mobile-text-xs);
    text-align: center;
    line-height: var(--mobile-leading-tight);
    letter-spacing: 0.5px;
  }

  /* Hide mobile nav on large screens where desktop nav is preferred */
  @media (min-width: 1024px) {
    .retro-mobile-nav {
      display: none;
    }
  }

  /* Mobile navigation responsive adjustments */
  @media (max-width: 480px) {
    .retro-nav-grid {
      grid-template-columns: repeat(5, 1fr);
      gap: 2px;
    }
    
    .retro-nav-item {
      padding: var(--mobile-spacing-xs) 2px;
    }
    
    .retro-nav-label {
      font-size: 6px;
    }
  }

  @media (min-width: 481px) and (max-width: 768px) {
    .retro-nav-grid {
      max-width: 600px;
      margin: 0 auto;
    }
  }

  /* Mobile-Optimized Territory Card Styles */
  .retro-territory-card {
    background: var(--pixel-white);
    border: 4px solid var(--pixel-black);
    box-shadow: 4px 4px 0 var(--pixel-gray);
    transition: all 0.2s ease;
    image-rendering: pixelated;
    touch-action: manipulation;
    user-select: none;
    position: relative;
    overflow: hidden;
    cursor: pointer;
    
    /* Mobile-first responsive design */
    padding: var(--mobile-spacing-sm);
    min-height: var(--touch-target-large);
    display: flex;
    align-items: center;
    gap: var(--mobile-spacing-sm);
  }

  @media (min-width: 480px) {
    .retro-territory-card {
      padding: var(--mobile-spacing-md);
      flex-direction: column;
      text-align: center;
      min-height: 200px;
    }
  }

  @media (min-width: 768px) {
    .retro-territory-card {
      padding: 1rem;
      min-height: 220px;
    }
  }

  .retro-territory-card:hover {
    transform: translate(-2px, -2px);
    box-shadow: 6px 6px 0 var(--pixel-gray);
  }

  .retro-territory-card:active {
    transform: translate(2px, 2px);
    box-shadow: 2px 2px 0 var(--pixel-gray);
  }

  .retro-territory-card.territory-owned {
    border-color: var(--retro-green-main);
    background: linear-gradient(135deg, 
        var(--retro-green-light) 0%, 
        var(--pixel-white) 100%);
  }

  .retro-territory-card.territory-selected {
    border-color: var(--retro-blue);
    background: linear-gradient(135deg, 
        #93c5fd 0%, 
        var(--pixel-white) 100%);
  }

  .territory-image {
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    
    /* Mobile-first sizing */
    width: var(--touch-target-medium);
    height: var(--touch-target-medium);
  }

  @media (min-width: 480px) {
    .territory-image {
      width: var(--touch-target-large);
      height: var(--touch-target-large);
      margin-bottom: var(--mobile-spacing-sm);
    }
  }

  .territory-flag,
  .territory-placeholder {
    font-size: var(--mobile-text-2xl);
    display: block;
  }

  @media (min-width: 480px) {
    .territory-flag,
    .territory-placeholder {
      font-size: 3rem;
    }
  }

  .territory-info {
    flex: 1;
    min-width: 0; /* Prevent flex item from overflowing */
  }

  .territory-name {
    font-family: 'Press Start 2P', monospace;
    color: var(--pixel-black);
    margin-bottom: var(--mobile-spacing-xs);
    word-break: break-word;
    line-height: var(--mobile-leading-tight);
  }

  .territory-region {
    color: var(--pixel-dark-gray);
    margin-bottom: var(--mobile-spacing-sm);
    font-weight: 600;
  }

  .territory-stats {
    display: flex;
    gap: var(--mobile-spacing-sm);
    margin-bottom: var(--mobile-spacing-sm);
    flex-wrap: wrap;
  }

  .territory-stat {
    display: flex;
    align-items: center;
    gap: var(--mobile-spacing-xs);
    background: rgba(0, 0, 0, 0.05);
    padding: var(--mobile-spacing-xs);
    border-radius: 4px;
    border: 1px solid var(--pixel-gray);
  }

  .stat-icon {
    font-size: var(--mobile-text-sm);
  }

  .stat-value {
    font-family: 'Press Start 2P', monospace;
    color: var(--pixel-black);
    font-weight: bold;
  }

  .territory-action {
    margin-top: auto;
  }

  .territory-owned-badge {
    background: var(--retro-green-main);
    color: var(--pixel-white);
    padding: var(--mobile-spacing-xs) var(--mobile-spacing-sm);
    border-radius: 4px;
    border: 2px solid var(--pixel-white);
    text-align: center;
    font-family: 'Press Start 2P', monospace;
    font-weight: bold;
  }

  .territory-price {
    text-align: center;
  }

  .price-label {
    display: block;
    color: var(--pixel-dark-gray);
    margin-bottom: var(--mobile-spacing-xs);
  }

  .price-value {
    font-family: 'Press Start 2P', monospace;
    color: var(--retro-green-main);
    font-weight: bold;
    display: block;
  }

  .swipe-indicator {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(0, 0, 0, 0.8);
    color: var(--pixel-white);
    text-align: center;
    padding: var(--mobile-spacing-xs);
    transform: translateY(100%);
    transition: transform 0.3s ease;
    font-family: 'Press Start 2P', monospace;
  }

  .swipe-indicator.swipe-visible {
    transform: translateY(0);
  }

  /* Territory card focus styles for accessibility */
  .retro-territory-card:focus {
    outline: 4px solid var(--retro-blue);
    outline-offset: 2px;
  }

  /* Mobile-Optimized Modal Styles */
  .retro-modal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    padding: var(--mobile-spacing-sm);
    transition: opacity 0.2s ease, visibility 0.2s ease;
  }

  .retro-modal-visible {
    opacity: 1;
    visibility: visible;
  }

  .retro-modal-hidden {
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
  }

  .retro-modal-content {
    background: var(--pixel-white);
    border: 4px solid var(--pixel-black);
    box-shadow: 8px 8px 0 var(--pixel-dark-gray);
    image-rendering: pixelated;
    max-width: 100%;
    max-height: 90vh;
    overflow-y: auto;
    width: 100%;
    
    /* Mobile-first responsive sizing */
    padding: var(--mobile-spacing-md);
    animation: retro-modal-appear 0.2s ease;
  }

  @media (min-width: 480px) {
    .retro-modal-content {
      width: 90%;
      max-width: 500px;
    }
  }

  @media (min-width: 768px) {
    .retro-modal-content {
      padding: var(--mobile-spacing-lg);
      max-width: 600px;
    }
  }

  .retro-modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--mobile-spacing-md);
    padding-bottom: var(--mobile-spacing-sm);
    border-bottom: 2px solid var(--pixel-black);
  }

  .retro-modal-close {
    background: var(--retro-red);
    color: var(--pixel-white);
    border: 2px solid var(--pixel-white);
    border-radius: 4px;
    font-family: 'Press Start 2P', monospace;
    font-size: var(--mobile-text-sm);
    cursor: pointer;
    transition: all 0.1s ease;
    touch-action: manipulation;
    user-select: none;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: var(--touch-target-small);
    min-width: var(--touch-target-small);
    padding: var(--mobile-spacing-xs);
  }

  .retro-modal-close:hover {
    background: #dc2626;
    transform: scale(1.05);
  }

  .retro-modal-close:active {
    transform: scale(0.95);
  }

  .retro-modal-body {
    margin-bottom: var(--mobile-spacing-md);
    font-family: 'Orbitron', 'Courier New', monospace;
    font-size: var(--mobile-text-sm);
    line-height: var(--mobile-leading-relaxed);
  }

  .retro-modal-footer {
    display: flex;
    gap: var(--mobile-spacing-sm);
    justify-content: flex-end;
    padding-top: var(--mobile-spacing-sm);
    border-top: 2px solid var(--pixel-gray);
    flex-wrap: wrap;
  }

  /* Mobile-specific modal footer layout */
  @media (max-width: 480px) {
    .retro-modal-footer {
      flex-direction: column;
      gap: var(--mobile-spacing-xs);
    }
    
    .retro-modal-footer .retro-touch-button,
    .retro-modal-footer .retro-touch-button-large {
      width: 100%;
    }
  }

  @keyframes retro-modal-appear {
    from {
      transform: scale(0.8) translateY(20px);
      opacity: 0;
    }
    to {
      transform: scale(1) translateY(0);
      opacity: 1;
    }
  }

  /* Prevent body scroll when modal is open */
  body.modal-open {
    overflow: hidden;
    position: fixed;
    width: 100%;
  }
}
