@page "/Error"
@using System.Diagnostics

<PageTitle>Error - World Leaders Game</PageTitle>

<div class="retro-game-container">
    <div class="max-w-2xl mx-auto p-8 text-center">
        <div class="pixel-art-card green-theme">
            <!-- Error Header -->
            <div class="mb-8">
                <h1 class="retro-title text-3xl mb-4" style="color: var(--retro-red);">
                    ⚠️ SYSTEM ERROR
                </h1>
                <h2 class="retro-subtitle mb-4" style="color: var(--retro-red);">
                    AN ERROR OCCURRED WHILE PROCESSING YOUR REQUEST
                </h2>
            </div>

            @if (ShowRequestId)
            {
                <div class="pixel-art-card mb-6" style="border-color: var(--retro-red);">
                    <p class="retro-body text-sm">
                        <strong>Request ID:</strong> <code class="retro-body text-xs">@RequestId</code>
                    </p>
                </div>
            }

            <!-- Error Details for Development -->
            <div class="pixel-art-card mb-8">
                <h3 class="retro-subtitle text-lg mb-4">🔧 DEVELOPMENT MODE</h3>
                <div class="text-left space-y-3">
                    <p class="retro-body text-sm">
                        Swapping to <strong>Development</strong> environment will display more detailed information about the error that occurred.
                    </p>
                    <p class="retro-body text-sm">
                        <strong>The Development environment shouldn't be enabled for deployed applications.</strong>
                        It can result in displaying sensitive information from exceptions to end users.
                    </p>
                    <p class="retro-body text-sm">
                        For local debugging, enable the <strong>Development</strong> environment by setting the 
                        <strong>ASPNETCORE_ENVIRONMENT</strong> environment variable to <strong>Development</strong>
                        and restarting the app.
                    </p>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="space-y-4">
                <button onclick="window.location.href='/'" 
                        class="pixel-art-button">
                    🏠 RETURN HOME
                </button>
                <button onclick="window.location.reload()" 
                        class="pixel-art-button"
                        style="background-color: var(--retro-blue);">
                    🔄 RELOAD PAGE
                </button>
            </div>

            <!-- Child-Friendly Message -->
            <div class="mt-8 retro-body text-xs opacity-75">
                <p>Don't worry! Our AI tutors are working to fix this issue.</p>
                <p>Your learning progress is safe! 🛡️</p>
            </div>
        </div>
    </div>
</div>

@code{
    [CascadingParameter]
    private HttpContext? HttpContext { get; set; }

    private string? RequestId { get; set; }
    private bool ShowRequestId => !string.IsNullOrEmpty(RequestId);

    protected override void OnInitialized() =>
        RequestId = Activity.Current?.Id ?? HttpContext?.TraceIdentifier;
}
